@model GestionInventarioWeb.Data.User;
@{
    Layout = "_Layout";
    ViewData["Title"] = "Dashboard";
}

<div class="container-fluid">
    <h2>Ventas</h2>
    @if(Model == null)
    {
        <div class="alert alert-warning">Error al obtener datos!</div>
    }
    else
    {
        <p>Hola @Model.Name</p>
        <p>Tu rut es @Model.Rut</p>
        <p>@Context.Session.GetString("Role")</p>
    }
</div>

<div class="container-fluid">
    <h2>Resultado</h2>
    <input type="button" class="btn btn-primary mb-2" value="Obtener" onclick="getData()"/>
    <ul id="lista" class="list-group mt-2">
    </ul>

</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

<script>
    function getData(){
        $.ajax({
            url: "/api/users",
            method: "get",
            datatype: "application/json",
            success: function (data) {
                console.log(data)
                let list = document.querySelector("#lista")
                let users = data
                for(var user of users){
                    let li = document.createElement("li")
                    li.innerHTML = user
                    li.classList.add("list-group-item")
                    list.appendChild(li)
                }

            },
            error: function (data) {
                console.log("ERROR!!" + data)
            }
        })
    }
</script>
